<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>nzw page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">nzw page</a>
              </div>
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Home</a></li>
                    <li class="active visible-xs-block"><a href="/links.html">Links</a></li>
                    <li class="active"><a href="/archive.html">Archive</a></li>
                    <li class="active"><a href="/about.html">About</a></li>
                    <li class="active"><a href="/feed.xml">RSS</a></li>

                </ul>
              </div>
        </div>
    </div>
</div>


<div class="container container-left">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class="sidebar well">
HP
</div>

<div class="sidebar well">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/2015/07/PRML99pi">PRML演習9.9 pi</a></li>
        
          <li><a href="/2015/07/PRML98">PRML演習9.8</a></li>
        
          <li><a href="/2015/07/PRML94">PRML演習9.4</a></li>
        
          <li><a href="/2015/07/hello">Hello</a></li>
        
          <li><a href="/2015/07/PRML93">PRML演習9.3</a></li>
        
    </ul>
</div>

<div class="sidebar well">
<h1>Links</h1>
<ul>
  <li><a href="https://github.com/nzw0301">github</a></li>
  <li><a href="https://twitter.com/nozawa0301">Twitter</a></li>
  <li><a href="http://nzw.hatenablog.jp/">Hatena</a></li>
  <li><a href="http://wkblab.github.io/member/nzw.html">Research</a></li>
</ul>

</div>

        </div>
        <div class="col-md-9">
            
<div class="article">
    <div class="well">
        <h1><a href="/2015/07/PRML99pi">Jul 15, 2015 - PRML演習9.9 pi</a></h1>
        
        <div class="content">
            <h3 id="本題">本題</h3>

<p>負担率を固定した際に，式(9.40)を
\(\pi_{k}\)
について最大化しようとすると式(9.22)で与えられる陽な解が得られることを示す．</p>

<p>\( \sum_k \pi_k = 1 \)
という条件があるので，ラグランジュの未定乗数法を利用する．</p>

<p>式(9.40)を
\(\pi_{k}\)
について最大化しつつ，
\( \sum_k \pi_k = 1 \)
を満たすように最大化を行う．</p>

<p>ラグランジュ関数は
\( L(\boldsymbol{\pi},\lambda) = f(\boldsymbol{\pi}) + \lambda ( \sum_k \pi_k - 1) \)
となる．</p>

<p>\( f(\boldsymbol{\pi} ) \)
は式9.40をさします．</p>

<p>ラグランジュ関数を
\(\boldsymbol{\pi_k}\)
について微分して0と置いた式と制約を満たすことから，</p>

<p>\begin{eqnarray}
\sum^N_{n=1} \gamma(z_{nk}) \frac{1}{\pi_k} + \lambda = 0 \\
\sum_k \pi_k - 1 = 0
\end{eqnarray}</p>

<p>を使って
\( \lambda \)
について求める．</p>

<p>微分した式を条件式に代入すると，</p>

<p>\( - \sum_k \frac{N_k}{\lambda} = 1 \)
なので，</p>

<p>\( \lambda = -N \)</p>

<p>よって</p>

<p>\( \pi_k = \frac{N_k}{N} \)
式(9.22)を導くことができた．</p>

        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2015/07/PRML98">Jul 12, 2015 - PRML演習9.8</a></h1>
        
        <div class="content">
            <h3 id="本題">本題</h3>

<p>負担率を固定した際に，式(9.40)を
\(\boldsymbol{\mu_{k}}\)
について最大化しようとすると式(9.17)で与えられる陽な解が得られることを示す．</p>

<p>式(9.40)を
\(\boldsymbol{\mu_{k}}\)
で微分する．
式(9.16)を)参考．</p>

<p>\begin{eqnarray}
\frac{\partial}{\partial \mu_k} E_\boldsymbol{z}
[\boldsymbol{X},\boldsymbol{Z}|\boldsymbol{\mu},\boldsymbol{\Sigma},\boldsymbol{\pi}]
&amp;=&amp; 
\sum_{n=1}^{N} \gamma(z_{zk}) \boldsymbol{\Sigma_k^{-1}}(\boldsymbol{x_n}-\boldsymbol{\mu_k})
\end{eqnarray}</p>

<p>微分した式を0とおいて，
\(\mu_k\)
について求める．</p>

<p>\begin{eqnarray}
\sum_{n=1}^{N} \gamma(z_{zk}) \boldsymbol{\Sigma_k^{-1}}(\boldsymbol{x_n}-\boldsymbol{\mu_k})
&amp;=&amp; 0 \\
\sum_{n=1}^{N} \gamma(z_{zk})(\boldsymbol{x_n}-\boldsymbol{\mu_k})
&amp;=&amp; 0 \\
\sum_{n=1}^{N} \gamma(z_{zk})\boldsymbol{\mu_k}
&amp;=&amp; 
\sum_{n=1}^{N} \gamma(z_{zk}) \boldsymbol{x_n} \\
\boldsymbol{\mu_k} 
&amp;=&amp;
\frac{1}{\sum_{n=1}^{N} \gamma(z_{zk})}\sum_{n=1}^{N} \gamma(z_{zk}) \boldsymbol{x_n}
\end{eqnarray}</p>

<p>以上から式(9.17)が得られた．</p>

<h3 id="所感">所感</h3>

<p>公式の答えは上巻のガウス分布の式を使っていますので，私の解答はちょっとやりかたが違ってるかもしれません．</p>

        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2015/07/PRML94">Jul 7, 2015 - PRML演習9.4</a></h1>
        
        <div class="content">
            <h3 id="おさらい">おさらい</h3>

<p>p156にあるように一般のEMアルゴリズムでは，
尤度関数 \(p(\boldsymbol{X}|\boldsymbol{\theta})\) を
\(\boldsymbol{\theta}\)
について最大化を目的とした．</p>

<p>今回の問いでは尤度関数を\(p(\boldsymbol{\theta}|\boldsymbol{X})\) にして\(\boldsymbol{\theta}\) について最大化する．</p>

<h3 id="本題">本題</h3>

<ul>
<li><p>観測変数は
\(\boldsymbol{X}\)</p></li>
<li><p>\(\boldsymbol{\theta}\) は任意のパラメータ</p></li>
<li><p>\(\boldsymbol{Z}\)
は潜在変数</p></li>
</ul>

<p>まず
パラメータの初期値
\(\boldsymbol{\theta^{old}}\)
を選ぶ．</p>

<p>Eステップ．
\(p(\boldsymbol{Z}|\boldsymbol{X},\boldsymbol{\theta^{old}})\)
を計算する．
ここまではp156のアルゴリズムと同じ．</p>

<p>Mステップ．
最大化する対数尤度関数は
\(\ln{p(\boldsymbol{\theta}|\boldsymbol{X})} \)
である．</p>

<p>ベイズの定理から</p>

<p>\begin{eqnarray}
\ln{p(\boldsymbol{\theta}|\boldsymbol{X})}  &amp;=&amp;
\ln{\frac{p(\boldsymbol{X}|\boldsymbol{\theta})p(\boldsymbol{\theta})}{p(\boldsymbol{X})}}  \\
&amp;=&amp; \ln{p(\boldsymbol{X}|\boldsymbol{\theta})}
+ \ln{p(\boldsymbol{\theta})}
- \ln{p(\boldsymbol{X})} \\
&amp;=&amp; \ln{(\sum_{\boldsymbol{Z}} p(\boldsymbol{X,Z}|\boldsymbol{\theta}))}
+ \ln{p(\boldsymbol{\theta})}
- \ln{p(\boldsymbol{X})}\
\end{eqnarray}
と変形する.</p>

<p>変形した式を
\(\boldsymbol{\theta}\)
について最大化するが，第1項は．Q関数なので，</p>

<p>\begin{eqnarray}
\boldsymbol{\theta^{new}} &amp;=&amp; argmax_{\boldsymbol{\theta}} (Q(\boldsymbol{\theta},\boldsymbol{\theta^{old}}) + \ln{p(\boldsymbol{\theta})})
\end{eqnarray}</p>

<p>をMステップでは計算する．</p>

<p>ベイズの定理で変形して出てきた
\(\ln{p(\boldsymbol{X})}\)
は
\(\boldsymbol{\theta}\)
とは，関係ないために定数として扱えるので，最大化する際には無視できる．</p>

<h3 id="その他">その他</h3>

<p><a href="http://amzn.to/1fki6cc">言語処理のための機械学習入門 (自然言語処理シリーズ)  </a>のp88を参考にしました．</p>

        </div>
    </div>
</div>


<div class="pagination">
  
  <span class="page_number ">Page: 1 of 2</span>
  
    <a class="btn btn-default" href="/page2" class="next">Older</a>
  
</div>

        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2015 nzw page. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>




  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56934733-2', 'auto');
    ga('send', 'pageview');
  </script>



</body>
</html>

