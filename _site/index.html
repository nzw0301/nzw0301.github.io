<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>nzw page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>

<body>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">nzw page</a>
              </div>
              <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Home</a></li>
                    <li class="active visible-xs-block"><a href="/links.html">Links</a></li>
                    <li class="active"><a href="/archive.html">Archive</a></li>
                    <li class="active"><a href="/about.html">About</a></li>
                    <li class="active"><a href="/feed.xml">RSS</a></li>

                </ul>
              </div>
        </div>
    </div>
</div>


<div class="container container-left">
    <div class="row">
        <div class="col-md-3 hidden-xs">
            <div class="sidebar well">
メモと個人ページ
</div>

<div class="sidebar well">
    <h1>Recent Posts</h1>
    <ul>
        
          <li><a href="/2015/07/prml2_15">PRML 演習2.15</a></li>
        
          <li><a href="/2015/07/prml2_12">PRML 演習2.12</a></li>
        
          <li><a href="/2015/07/pythonIntro">Python勉強メモ</a></li>
        
          <li><a href="/2015/07/PRML99pi">PRML演習9.9 pi</a></li>
        
          <li><a href="/2015/07/PRML98">PRML演習9.8</a></li>
        
    </ul>
</div>

<div class="sidebar well">
<h1>Links</h1>
<ul>
  <li><a href="https://github.com/nzw0301">github</a></li>
  <li><a href="https://twitter.com/nozawa0301">Twitter</a></li>
  <li><a href="http://nzw.hatenablog.jp/">Hatena</a></li>
  <li><a href="http://wkblab.github.io/member/nzw.html">Research</a></li>
  <li><a href="http://www.amazon.co.jp/gp/registry/wishlist/?ie=UTF8&camp=1207&creative=8415&linkCode=shr&tag=algebrae-22&requiresSignIn=1">wish list</a></li>
</ul>

</div>

        </div>
        <div class="col-md-9">
            
<div class="article">
    <div class="well">
        <h1><a href="/2015/07/prml2_15">Jul 21, 2015 - PRML 演習2.15</a></h1>
        
        <div class="content">
            <p>多変量ガウス分布のエントロピーが</p>

<p>\begin{eqnarray}
H[\boldsymbol{x}] = \frac{1}{2} \ln | \boldsymbol{\Sigma}| + \frac{D}{2}(1+\ln(2\pi))
\end{eqnarray}</p>

<p>になることを示す．</p>

<p>多変量ガウス分布は連続であるのでエントロピーの定義から</p>

<p>\begin{eqnarray}
H[\boldsymbol{x}] = - \int p(\boldsymbol{x}) \ln p(\boldsymbol{x}) d \boldsymbol{x}.
\end{eqnarray}</p>

<p>また多変量ガウス分布は，
式(2.43)をエントロピーの式に代入し， \(\ln\) の関数の期待値とみることができるので</p>

<p>\begin{eqnarray}
H[\boldsymbol{x}] &amp;=&amp; - \int p(\boldsymbol{x}) \ln \Bigl(\frac{1}{(2\pi)^\frac{D}{2}}
\frac{1}{|\boldsymbol{\Sigma}|^{\frac{1}{2}}}
exp \bigl({-\frac{1}{2} (\boldsymbol{x}-\boldsymbol{\mu})^{\mathrm{T}} \boldsymbol{\Sigma}^{-1}
(\boldsymbol{x}-\boldsymbol{\mu})}
\bigr)\Bigr) d \boldsymbol{x} \\
&amp;=&amp;-(-\frac{D}{2}\ln{(2\pi)} -
\frac{1}{2}\ln |\boldsymbol{\Sigma}| -
\frac{1}{2}
E[(\boldsymbol{x}-\boldsymbol{\mu})^{\mathrm{T}} \boldsymbol{\Sigma}^{-1} (\boldsymbol{x}-\boldsymbol{\mu})]
) \\
\end{eqnarray}</p>

<p>ここでトレースを使う（線形代数でトレースを習わなかったので，ここに時間がかかりました）</p>

<h1 id="トレース">トレース</h1>

<p>トレースは，行列の対角和のことです．
単位行列のトレースは，単位行列の次元数です．</p>

<p>トレースの性質から
もしAが対称行列であるなら</p>

<p>\( X^{\mathrm{T}} A X = tr(A X X^{\mathrm{T}} ) \)</p>

<p>を満たす．</p>

<p>さきほどの式の最後の項の期待値の中身がこれで書き換えると，</p>

<p>\begin{eqnarray}
(\boldsymbol{x}-\boldsymbol{\mu})^{\mathrm{T}} \boldsymbol{\Sigma}^{-1} (\boldsymbol{x}-\boldsymbol{\mu}) =
tr (\boldsymbol{\Sigma}^{-1} (\boldsymbol{x}-\boldsymbol{\mu}) (\boldsymbol{x}-\boldsymbol{\mu})^{\mathrm{T}})
\end{eqnarray}</p>

<p>第3項目だけ取り出して変形していく．</p>

<p>\begin{eqnarray}
E[(\boldsymbol{x}-\boldsymbol{\mu})^{\mathrm{T}} \boldsymbol{\Sigma}^{-1} (\boldsymbol{x}-\boldsymbol{\mu})] &amp;=&amp;
E[tr (\boldsymbol{\Sigma}^{-1} (\boldsymbol{x}-\boldsymbol{\mu}) (\boldsymbol{x}-\boldsymbol{\mu})^{\mathrm{T}})] \\
&amp;=&amp; tr (\boldsymbol{\Sigma^{-1}} E[(\boldsymbol{x}-\boldsymbol{\mu}) (\boldsymbol{x} -
\boldsymbol{\mu}^{\mathrm{T}})]) \\
&amp;=&amp; tr (\boldsymbol{\Sigma^{-1}} \boldsymbol{\Sigma} ) \\
&amp;=&amp; D
\end{eqnarray}</p>

<p>よって</p>

<p>\begin{eqnarray}
H[\boldsymbol{x}] = \frac{1}{2} \ln | \boldsymbol{\Sigma}| + \frac{D}{2}(1+\ln(2\pi))
\end{eqnarray}</p>

<p>以上.</p>

<h1 id="所感">所感</h1>

<p>期待値は線形性を持っているのでトレースと順番入れ替えたのがちょっと心配です．</p>

<h1 id="参考にした記事">参考にした記事</h1>

<ul>
<li><a href="http://sucrose.hatenablog.com/entry/2013/07/20/190146">正規分布間のKLダイバージェンスの導出</a></li>
<li><a href="http://www.math.uwaterloo.ca/~hwolkowi/matrixcookbook.pdf">Matrix Cookbook</a></li>
<li><a href="http://www.r.dl.itc.u-tokyo.ac.jp/~nakagawa/SML1/math1.pdf">付録1．数学の復習</a></li>
</ul>

        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2015/07/prml2_12">Jul 16, 2015 - PRML 演習2.12</a></h1>
        
        <div class="content">
            <h1 id="はじめに">はじめに</h1>

<p>9章で混合ガウス分布がこれでもかと出てくるので，一旦2章まで戻りました．
ディリクレ分布までやったので今度はガウス分布です．</p>

<h4 id="1-正規化の確認">1. 正規化の確認</h4>

<p>連続変数なので，全区間を積分して1になることを確かめればよい．</p>

<p>\begin{eqnarray}
\int_a^b \frac{1}{b-a} dx &amp;=&amp; [\frac{x}{b-a}]_a^b \\
&amp;=&amp; \frac{b}{b-a} - \frac{a}{b-a} \\
&amp;=&amp; 1
\end{eqnarray}</p>

<h4 id="2-平均">2. 平均</h4>

<p>式(1.34)を使うだけ</p>

<p>\begin{eqnarray}
E[x] &amp;=&amp; \int_a^b x \frac{1}{b-a} dx \\
&amp;=&amp; [\frac{x^2}{2(b-a)}]_a^b \\
&amp;=&amp; \frac{b^2}{2(b-a)} - \frac{a^2}{2(b-a)} \\
&amp;=&amp; \frac{a+b}{2}
\end{eqnarray}</p>

<h4 id="3-分散">3. 分散</h4>

<p>求めた平均と式(1.39)を使う</p>

<p>\begin{eqnarray}
var[x] &amp;=&amp; \int_a^b x^2 \frac{1}{b-a} dx - E[x]^2 \\
&amp;=&amp; [\frac{x^3}{3(b-a)}]_a^b - \frac{(a+b)^2}{4}\\
&amp;=&amp; \frac{b^2+ab+a^2}{3} - \frac{(a+b)^2}{4}\\
&amp;=&amp; \frac{(a-b)^2}{12}
\end{eqnarray}</p>

<p>一様分布についてのもう少しだけ詳しい説明が付録Bにあります．</p>

        </div>
    </div>
</div>

<div class="article">
    <div class="well">
        <h1><a href="/2015/07/pythonIntro">Jul 16, 2015 - Python勉強メモ</a></h1>
        
        <div class="content">
            <h1 id="はじめに">はじめに</h1>

<p>講義の関係で少しだけNLTKとかgensimとかflaskを触りましたが，
全然Pythonわからないので，いい加減勉強します．</p>

<p>図書館にあったこれをひと通り読むつもりです．</p>

<p><a href="http://www.amazon.co.jp/gp/product/4873116880/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=4873116880&linkCode=as2&tag=algebrae-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=4873116880&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=algebrae-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=algebrae-22&l=as2&o=9&a=4873116880" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<h1 id="環境">環境</h1>

<ul>
<li>pyenv</li>
<li>anaconda3-2.1.0</li>
<li>Jupyter</li>
</ul>

<p>Javaをよく書くのでJythonも検討しましたが，Javaとの連携がめんどうそうで手間でやめました．</p>

<p>速い速いと聞くpypyもやろうとしましたが，パッケージ周りがめんどうだったのでやめました．</p>

<p>scikit-learnなどをやりたい方はanacondaを入れると必要なパッケージがだいたい入ってて簡単です．</p>

<h1 id="本題">本題</h1>

<p>まずを環境つくります．
グローバルでパッケージを管理したくないので，virtualenvを使います．</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">pip install virtualenv
virtualenv no-site-packages anaconda3
cd anaconda3
. bin/activate #この環境を使う
deactivate #この環境から抜ける
</code></pre></div>
<p>REPLでも十分ですが，jupyterでよりインタラクティブにpython使ってみます．
ちなみにJuliaもつかえます．</p>

<p>jupyterからhtmlのslideも作れちゃうので，tutorialには便利そうです．</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">pip install ipython
ipython notebook #ブラウザが起動
</code></pre></div>
        </div>
    </div>
</div>


<div class="pagination">
  
  <span class="page_number ">Page: 1 of 3</span>
  
    <a class="btn btn-default" href="/page2" class="next">Older</a>
  
</div>

        </div>
        
    </div>
</div>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span12 footer navbar-inverse navbar-fixed-bottom">
            <p class="copyright">&copy;2015 nzw page. Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme by <a href="https://github.com/scotte/jekyll-clean">Scott Emmons</a>
            under
            <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution</a></p>
        </div>
    </div>
</div>




  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56934733-2', 'auto');
    ga('send', 'pageview');
  </script>



</body>
</html>

