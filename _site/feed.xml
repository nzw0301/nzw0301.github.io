<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
	<channel>
		<title>nzw page</title>
		<description>HP</description>
		<link></link>
		<atom:link href="/feed.xml" rel="self" type="application/rss+xml" />
		
			<item>
				<title>PRML演習9.4</title>
				<description>&lt;h3 id=&quot;おさらい&quot;&gt;おさらい&lt;/h3&gt;

&lt;p&gt;p156にあるように一般のEMアルゴリズムでは，
尤度関数 \(p(\boldsymbol{X}|\boldsymbol{\theta})\) を
\(\boldsymbol{\theta}\)
について最大化を目的とした．&lt;/p&gt;

&lt;p&gt;今回の問いでは尤度関数を\(p(\boldsymbol{\theta}|\boldsymbol{X})\) にして\(\boldsymbol{\theta}\) について最大化する．&lt;/p&gt;

&lt;h3 id=&quot;本題&quot;&gt;本題&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;観測変数は
\(\boldsymbol{X}\)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;\(\boldsymbol{\theta}\) は任意のパラメータ&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;\(\boldsymbol{Z}\)
は潜在変数&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;まず
パラメータの初期値
\(\boldsymbol{\theta^{old}}\)
を選ぶ．&lt;/p&gt;

&lt;p&gt;Eステップ．
\(p(\boldsymbol{Z}|\boldsymbol{X},\boldsymbol{\theta^{old}})\)
を計算する．
ここまではp156のアルゴリズムと同じ．&lt;/p&gt;

&lt;p&gt;Mステップ．
最大化する対数尤度関数は
\(\ln{p(\boldsymbol{\theta}|\boldsymbol{X})} \)
である．&lt;/p&gt;

&lt;p&gt;ベイズの定理から&lt;/p&gt;

&lt;p&gt;\begin{eqnarray}
\ln{p(\boldsymbol{\theta}|\boldsymbol{X})}  &amp;amp;=&amp;amp;
\ln{\frac{p(\boldsymbol{X}|\boldsymbol{\theta})p(\boldsymbol{\theta})}{p(\boldsymbol{X})}}  \\
&amp;amp;=&amp;amp; \ln{p(\boldsymbol{X}|\boldsymbol{\theta})}
+ \ln{p(\boldsymbol{\theta})}
- \ln{p(\boldsymbol{X})} \\
&amp;amp;=&amp;amp; \ln{(\sum_{\boldsymbol{Z}} p(\boldsymbol{X,Z}|\boldsymbol{\theta}))}
+ \ln{p(\boldsymbol{\theta})}
- \ln{p(\boldsymbol{X})}\
\end{eqnarray}
と変形する.&lt;/p&gt;

&lt;p&gt;変形した式を
\(\boldsymbol{\theta}\)
について最大化するが，第1項は．Q関数なので，&lt;/p&gt;

&lt;p&gt;\begin{eqnarray}
\boldsymbol{\theta^{new}} &amp;amp;=&amp;amp; argmax_{\boldsymbol{\theta}} Q(\boldsymbol{\theta},\boldsymbol{\theta^{old}}) + \ln{p(\boldsymbol{\theta})}
\end{eqnarray}&lt;/p&gt;

&lt;p&gt;をMステップでは計算する．&lt;/p&gt;

&lt;p&gt;ベイズの定理で変形して出てきた
\(\ln{p(\boldsymbol{X})}\)
は
\(\boldsymbol{\theta}\)
とは，関係ないために定数として扱えるので，最大化する際には無視できる．&lt;/p&gt;

&lt;h3 id=&quot;その他&quot;&gt;その他&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;http://amzn.to/1fki6cc&quot;&gt;言語処理のための機械学習入門 (自然言語処理シリーズ)  &lt;/a&gt;のp88を参考にしました．&lt;/p&gt;
</description>
				<pubDate>Tue, 07 Jul 2015 22:25:06 +0900</pubDate>
				<link>/2015/07/PRML94</link>
				<guid isPermaLink="true">/2015/07/PRML94</guid>
			</item>
		
			<item>
				<title>Hello</title>
				<description>&lt;h1 id=&quot;半分くらい移転しました&quot;&gt;半分くらい移転しました&lt;/h1&gt;

&lt;p&gt;はてなブログで数式を書くと展開されずにつらいかったり，やたら読み込みが重いので，こちらに書いていこうかと思います．&lt;/p&gt;
</description>
				<pubDate>Sun, 05 Jul 2015 18:25:06 +0900</pubDate>
				<link>/2015/07/hello</link>
				<guid isPermaLink="true">/2015/07/hello</guid>
			</item>
		
			<item>
				<title>PRML演習9.3</title>
				<description>&lt;p&gt;\( K=2 \) とすると定義より \(\boldsymbol{z}\) は
\begin{align}
\boldsymbol{z} = [0,1],[1,0]
\end{align}
の2つのベクトルのうちどちらかを取りうる．&lt;/p&gt;

&lt;p&gt;また，以下の式の一番外側のシグマはこの2つの \(\boldsymbol{z}\) を足し合わせる．&lt;/p&gt;

&lt;p&gt;\begin{eqnarray}
\sum_{\boldsymbol{z}}p(\boldsymbol{z})p(\boldsymbol{x}|\boldsymbol{z}) &amp;amp;=&amp;amp; \sum_{\boldsymbol{z}} \prod_{k=1}^2 \pi_k^{z_k} \prod_{k=1}^2 N(\boldsymbol{x}|\boldsymbol{\mu_k}, \Sigma_{k})^{z_k} \\
&amp;amp;=&amp;amp; \sum_{\boldsymbol{z}}(\pi_1^{z_1}\pi_2^{z_2})(N(\boldsymbol{x}|\boldsymbol{\mu_1},\Sigma_1)^{z_1} N(\boldsymbol{x}|\boldsymbol{\mu_2},\Sigma_2)^{z_2} \\
&amp;amp;=&amp;amp; \pi_1 N(\boldsymbol{x}|\boldsymbol{\mu_1},\Sigma_1) + \pi_2 N(\boldsymbol{x}|\boldsymbol{\mu_2},\Sigma_2) \\
&amp;amp;=&amp;amp; \sum_{k=1}^2 \pi_k N(\boldsymbol{x}|\boldsymbol{\mu_k},\Sigma_k)
\end{eqnarray}&lt;/p&gt;

&lt;p&gt;一般化して \(K\) の場合は，
\(\sum_{\boldsymbol{z}}p(\boldsymbol{z})p(\boldsymbol{x}|\boldsymbol{z})\)
は，内部の同時確率を変形した式を \(\prod\) 展開してから
\(\sum_{\boldsymbol{z}}\) で足しあわせる．&lt;/p&gt;

&lt;p&gt;足し合わせると
\(z_k=1\) を満たす \(k\) での
\(\pi_k N(\boldsymbol{x}|\boldsymbol{\mu_k},\Sigma_k)\) の
添字が1から\(K\)までの和だけが残るために
式(9.12)のように周辺化することで式(9.7)を導くことができる．&lt;/p&gt;
</description>
				<pubDate>Sun, 05 Jul 2015 14:25:06 +0900</pubDate>
				<link>/2015/07/PRML93</link>
				<guid isPermaLink="true">/2015/07/PRML93</guid>
			</item>
		
	</channel>
</rss>
